build-magic:
  - stage:
      name: Run Tests
      commands:
        - execute: flake8 --count --show-source --statistics
        - test: pytest tests/test* --cov=build_magic --cov-report term-missing
  - stage:
      name: Build Documentation
      action: cleanup
      commands:
        - build: mkdocs build
        - deploy: mkdocs gh-deploy
  - stage:
      name: Deploy to PyPI
      action: cleanup
      commands:
        - build: python setup.py sdist bdist_wheel --universal
        - release: twine upload dist/*